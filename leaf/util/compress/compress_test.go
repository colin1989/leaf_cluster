package compress

import (
	"fmt"
	"testing"
	"time"
)

func TestEncodeDecode(t *testing.T) {
	old := time.Now()
	defer func() {
		d := time.Since(old)
		fmt.Println("cost:", d)
	}()

	jsonStr := `{"S2C_User":{"User":{"UserID":210001,"AccID":6212,"Name":"","CreTime":0,"LogoutTime":0,"LoginTime":0,"OnlineSecond":0,"ChanName":"","ChanAcc":"","ServerId":1,"LoadTime":0,"KeepTime":0,"Referrer":0,"ReferrerAward":0,"YallaPayFlag":0,"NewRole":0,"NoChatTime":0,"NoChatTimeSys":0,"LastWorldChatTime":0,"LastWorldChatNum":0,"NoLoginTime":0,"MailId":0,"WorldMailID":0,"VersionRepair":0,"VersionRepairFlag":false,"RechArr":null,"Moneys":null,"Tokens":null,"NewShop":null,"Build":null,"College":null,"MainCity":null,"Battle":{},"Chapter":null,"Power":{"Sum":0,"MaxSum":0,"Build":0,"Arm":0,"Hero":0,"College":0,"Castle":0,"ArmPart":0,"GodBeast":0,"BigSum":{"Value":""},"BigMaxSum":{"Value":""},"ZWin":0,"ZLose":0,"JWin":0,"JLose":0,"FWin":0,"Odds":0,"Kill":0,"Loss":0},"Attr":{"Id":0,"BAtt":0,"BDef":0,"BHp":0,"QAtt":0,"QDef":0,"QHp":0,"YAtt":0,"YDef":0,"YHp":0,"AAtt":0,"ADef":0,"AHp":0,"Dam":0,"DamDef":0,"Speed":0,"Crit":0,"CritDam":0,"Hit":0,"CityAtt":0,"CityDef":0,"BMiss":0,"QMiss":0,"YMiss":0,"Miss":0,"MarchNum":0,"MarchOdds":0,"MarchQueue":0,"Hospital":0,"HospitalO":0,"ArmSpeed":0,"MarchSpeed":0,"Gold":0,"Wood":0,"Food":0,"Iron":0,"GoldSpeed":0,"WoodSpeed":0,"FoodSpeed":0,"IronSpeed":0,"ResSpeed":0,"Warehouse":0,"WarehouseO":0,"Weight":0,"Strength":0,"HospitalSpeed":0,"MonMarchSpeed":0,"BArmSpeed":0,"QArmSpeed":0,"GArmSpeed":0,"BSquare":0,"QSquare":0,"YSquare":0,"BDam":0,"BDamDef":0,"BSpeed":0,"BCrit":0,"BCritDam":0,"QDam":0,"QDamDef":0,"QSpeed":0,"QCrit":0,"QCritDam":0,"YDam":0,"YDamDef":0,"YSpeed":0,"YCrit":0,"YCritDam":0,"CollegeSpeed":0,"BHit":0,"QHit":0,"YHit":0,"UnCrit":0,"BUnCrit":0,"QUnCrit":0,"YUnCrit":0,"CritDamDef":0,"BCritDamDef":0,"QCritDamDef":0,"YCritDamDef":0,"BQDam":0,"BYDam":0,"QBDam":0,"QYDam":0,"YBDam":0,"YQDam":0,"BQDamdown":0,"BYDamdown":0,"QBDamdown":0,"QYDamdown":0,"YBDamdown":0,"YQDamdown":0,"MonAtt":0,"MonPS":0,"FreeCure":0,"WarHallNum":0},"Hospital":{"Arr":null,"Wait":null,"Time":0,"NewArr":null,"NewWait":null,"Expansion":{"Num":0,"Times":0},"Repair":false,"Unlock":false},"ShopUpdate":{"Shops":null,"Status":null,"OTime":0,"ETime":0,"Num":0,"Flag":0,"One":0,"New":0},"Supply":{"Items":null,"Time":0,"Num":0},"VideoShop":{"List":null,"Num":0},"WarHall":{"Info":null,"Hero":[0,0],"Records":null,"Arm":null,"MNum":0,"GodIds":[0,0]},"WorldMap":{"Obj":null,"Time":0,"Marches":null,"NpcMarches":null,"Unlock":false},"Castle":{"CId":0,"MCId":0,"SCId":0,"SNId":0,"SAId":0,"CBId":0},"Hero":null,"Strength":{"Value":0,"Max":0,"Time":0,"Buy":0},"Sweep":{"Value":0,"Max":0,"Time":0},"EquipEnergy":{"Value":0,"Max":0,"Time":0},"Defense":{"Value":0,"Max":0,"Time":0},"Mark":null,"NewArmGet":null,"NewBuildGet":null,"NewBuildTypeGet":null,"Buff":null,"Expedition":{"CId":0,"ChapterAward":null,"HeroArr":null,"FastTime":0,"FastNum":0,"FinishTime":0,"MingAward":null,"ArmNum":0,"Time":0,"DropSum":0,"Buy":0,"Info":null,"College":null},"Recharge2":{"Gift":null,"Time":0,"NTime":0,"State":0},"SetTeam":{"Arr":null},"TriggerGift":{"List":null,"ZSFree":{"State":0,"Num":0,"Items":null,"Time":0}},"SearchSet":null,"PlayerCollege":null,"PlayerBuff":null,"GodBeast":null,"Visit":null,"HeroTJ":null,"AutoMonster":null,"Sub":{"Subscribe":0,"SubscribeGet":0,"Follow":0,"FollowGet":0,"Switch":null},"NewRoleQueue":{"State":0,"Time":0},"MusterSet":{"Flag":0},"AutoMonsterCom":null,"Capture":null,"EquipMod":null,"CrossWarUser":{"CId":0,"MId":0},"Questionnaire":null,"ArmVal":null,"ArmValGet":null,"FuncUnlock":null,"MainLv":0,"FMainLv":0,"FunOpenAward":null,"WXShareList":null,"WXShareListTime":null,"CoverTime":0,"CoverKeep":0,"CoverCD":0,"CoverNew":0,"CoverItem":false,"MonsterLv":0,"MonUpTime":0,"DarkFortressLv":null,"RechargeGiftNowId":0,"RechargeGiftAward":0,"RechargeGift":0,"GuideId":null,"GuideMBaoNum":0,"GuideAward":0,"CastleInfos":null,"OpenFlag":null,"OneFlag":null,"Bags":{},"Mails":{},"Reset":null,"WeekResetTime":0,"Activation":0,"ActiArr":null,"ActivationIds":null,"SumCash":0,"SumMoney":0,"SumBaseMoney":0,"RechargeTime":0,"RealMoney":0,"Vip":0,"VipExp":0,"VipDay":0,"VipVipDay":0,"VipAward":null,"WeekSTime":0,"WeekSAward":null,"WeekSDayAward":0,"WeekTime":0,"WeekAward":0,"WeekDayAward":0,"GrowFundTime":0,"GrowFundAward":null,"MonthTime":0,"MonthAward":0,"MonthDayAward":0,"SeasonTime":0,"SeasonAward":0,"SeasonDayAward":0,"LifeTime":0,"LifeAward":0,"LifeDayAward":0,"DayAward":{"DaRecList":null},"SHeroGift":{"List":null},"DayLoginId":0,"DayLoginBuyTime":0,"DayLoginEndTime":0,"NewGift":{"List":null},"BingAward":0,"WeiDuan":0,"Attent":0,"YKe":0,"RealnameAward":0,"GM":0,"CreCliType":"","CliType":"","CliId":"","LastLoginIP":"192.168.1.30:49196","CreIP":"","ChannelId":0,"ForbesLev":0,"GangForbesLevBuy":0,"GangForbesFlag":0,"GangForbesTime":0,"GangForbesCAwards":0,"GangForbesGAwards":0,"GangWTaskOk":null,"GangDTaskDatas":null,"GangMTaskDatas":null,"MTaskDatas":null,"MTaskComMap":null,"RTaskDatas":null,"Road":0,"RoadLimit":0,"RoadCheck":false,"RoadTaskDatas":null,"Plot":0,"PlotLimit":0,"PlotCheck":false,"PTaskDatasMap":null,"PTaskDatas":null,"MSTaskDatas":null,"DTaskDatas":null,"DTaskOk":0,"DTaskOkMax":0,"DTaskRefresh":0,"DTaskOkBox":null,"MercenaryTasks":null,"NewHandTasks":null,"FriendList":null,"BlackList":null,"ChatToChatList":null,"ChatToChatWait":null,"MiningEx":null,"Mining":null,"GangId":0,"GangName":"","GangCode":"","GangInfo":{"LandCashNum":0,"LandGoldNum":0,"BagCashNum":0,"BagGoldNum":0,"RentHeroObjNum":null,"RentHeroNum":0,"RentHeroFree":0,"RentHeroBuy":0,"RentHeroUse":0,"MoveCity":null,"MoveCityOne":0,"MoveCityOneFlag":0,"RecordLogList":null,"HighTowerLocalDatas":{"List":null,"ResetTime":0,"GoldContributeNum":0,"RecoverTime":0,"DiamondContributeNum":0}},"GangRedCash":0,"RedCash":0,"MusterNum":0,"RewardNum":0,"GangMoveCityNum":0,"GangConDay":0,"GangAutoMonster":{"ETime":0,"Type":0},"GangGiftTip":0,"ProbeId":0,"ProbeNUm":0,"ProbePos":{"X":0,"Y":0},"ProbeOver":0,"ProbeCheck":0,"ProbeTask":null,"FreeCure":0,"WishNum":0,"GodNum":0,"Record_Recharge":null,"Record_Chapter":null,"Record_Plot":null,"Record_Road":null,"Record_MNum":0,"Record_PNum":0,"Record_DNum":0,"Record_CNum":0,"Record_Count":null,"Record_Day":null,"TreasureSEx":null,"WaAwardItemNum":0,"Post":{"Lev":0,"Exp":0,"Beacon":0,"BeaconUse":0,"BeaconFull":0,"TaskingArr":null,"TaskingGoldArr":null,"TaskMay":0,"TaskAddTime":0,"TaskReset":0,"TaskOdds":null,"StarOdds":[0,0,0,0,0],"GoldTaskDone":0,"TaskDone":0,"GoldTaskHIds":null},"GiftMap":null,"GiftNum":0,"GiftSelf":null,"ContributionId":0,"ContributionTime":0,"TaxLHit":0,"TaxTHit":0,"LoginCount":0,"LCATime":0,"HarvesterLv":0,"HarvesteTime":0,"HarvesteAdd":0,"HarvesteOver":0,"AutoHouseGet":0,"MiningNum":0,"MiningTime":0,"MiningAdd":0,"MiningDrop":0,"MiningArr":null,"ActivityCommMap":null,"CircusTroupeMap":null,"CircusTroupeLog":null,"ReferrerAwardPrevious":null,"ReferrerAwardNext":null,"LookAd":null,"GangNew":0,"HeroGiftTime":0,"Appoints":null,"ArenaFlag":false,"ArenaBuyNum":0,"ArenaUseFree":0,"ArenaFreeTime":null,"ArenaArmInfo":null,"ArenaRankV":0,"MemberSkillFree":0,"MemberSkillFreeLook":null,"MemberSkillCash":0,"HuntingNum":0,"HuntingLs":null,"RedBagRNum":0,"RedBagMNum":0,"MBaoNum":0,"OnlineStart":0,"OnlineSecs":0,"OnlineLs":null,"OnlineTime":0,"PowerSprintLs":null,"IdentityLv":0,"Exp":0,"Head":"","Pos":"","Sex":0,"ReName":0,"RePlace":0,"ReSex":0,"TotalDay":0,"GrandLogs":{"AwardList":null,"LastDay":0},"Exercise":null,"VoiceChat":null,"TowerSet":null,"RentHeroId":"","Gs":false,"LoginAnnouncementVersion":0,"GangBossHelp":0,"GangSendHelp":0,"GangHelpScore":0,"NewGuide":{"Ids":null,"Nodes":null},"GDShopTime":0,"GDShop":null},"NowTime":1668162395298,"OpenTime":1661961600}}`
	fmt.Println(len(jsonStr))

	for i := 0; i < 1; i++ {
		encode, err1 := Encode([]byte(jsonStr))
		if err1 != nil {
			fmt.Println(err1)
		}
		fmt.Println(len(encode))

		decode, err2 := Decode(encode)
		if err2 != nil {
			fmt.Println(err2)
		}
		fmt.Println(len(decode))
	}

}
